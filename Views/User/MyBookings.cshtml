@model IEnumerable<CoWorkManager.Models.Booking>
@{
    ViewData["Title"] = "My Bookings";
}

<div class="container">
    <h2 class="mb-4">My Bookings</h2>
    <div class="table-responsive card shadow-sm p-3 border-0">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>Workspace</th>
                    <th>Time Slot</th>
                    <th>Guests</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="bookingsTableBody">
                @foreach (var booking in Model)
                {
                    <tr>
                        <td><strong>@booking.Workspace?.Name</strong></td>
                        <td>@booking.StartTime.ToString("MMM dd, hh:mm tt")</td>
                        <td><span class="badge bg-light text-dark border">@(booking.Visitors?.Count ?? 0) Registered</span></td>
                        <td>
                            @* Added dynamic Bootstrap classes for status colors *@
                            <span class="badge @(booking.BookingStatus == "Confirmed" ? "bg-success" : 
                                               booking.BookingStatus == "Rejected" ? "bg-danger" : "bg-warning text-dark")">
                                @booking.BookingStatus
                            </span>
                        </td>
                        <td>
                            @if (booking.BookingStatus == "Pending")
                            {
                                <form asp-action="CancelBooking" method="post">
                                    <input type="hidden" name="id" value="@booking.BookingId" />
                                    <button type="submit" class="btn btn-sm btn-main">Cancel</button>
                                </form>
                            }
                            else if (booking.BookingStatus == "Confirmed")
                            {
                                <a asp-action="RegisterGuest" asp-route-bookingId="@booking.BookingId" class="btn btn-sm btn-main">Manage Guests</a>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

